Bridge.assembly("testjs",function(){"use strict";Bridge.define("Test.Labyrinth",{fields:{dungeon:null,value:0,roomPointsY:null,roomPointsX:null,roomOuterPointsY:null,roomOuterPointsX:null,choosePointX:null,choosePointY:null},props:{Dungeon:{get:function(){return this.dungeon},set:function(){this.Dungeon=this.dungeon}}},ctors:{init:function(){this.roomPointsY=new(System.Collections.Generic.List$1(System.Int32));this.roomPointsX=new(System.Collections.Generic.List$1(System.Int32));this.roomOuterPointsY=new(System.Collections.Generic.List$1(System.Int32));this.roomOuterPointsX=new(System.Collections.Generic.List$1(System.Int32));this.choosePointX=new(System.Collections.Generic.List$1(System.Int32));this.choosePointY=new(System.Collections.Generic.List$1(System.Int32))},ctor:function(Value,level){var y,x;for(Value===void 0&&(Value=40),level===void 0&&(level=0),this.$initialize(),this.dungeon=System.Array.create(0,null,System.Char,Value,Value),this.value=Value,y=0;y<this.value;y=y+1|0)for(x=0;x<this.value;x=x+1|0)(y===0||y===(this.value-1|0))&&this.dungeon.set([y,x],111),x===0||x===(this.value-1|0)?this.dungeon.set([y,x],111):x%2==0||y%2==0?this.dungeon.set([y,x],111):this.dungeon.set([y,x],120);this.GenerateRoomPoints();this.GenerateRoomFromPoints();this.GenerateMainWays();this.GenerateOtherWays();this.ConnectMainWaysToOtherWays();this.MakeLeftoverPointsToCrossings();this.RemoveUselessDeadends();this.MakeRoomConnectionComplete();this.SetSpawnAndDestinationPoint();this.ResetOuterWall()}},methods:{log:function(){for(var loginfo="",c1,c2,loginfo=System.String.concat(loginfo,"Raumpunkte: \n"),c=0;c<this.roomPointsX.Count;c=c+1|0)loginfo=System.String.concat(loginfo,System.String.concat("Punkt: Y: ",this.roomPointsY.getItem(c).toString()," X: ",this.roomPointsY.getItem(c).toString(),"\n"));for(loginfo=System.String.concat(loginfo,"Ã„usere Raumpunkte: \n"),c1=0;c1<this.roomOuterPointsX.Count;c1=c1+1|0)loginfo=System.String.concat(loginfo,System.String.concat("OuterPunkt: Y: ",this.roomOuterPointsY.getItem(c1).toString()," X: ",this.roomOuterPointsY.getItem(c1).toString(),"\n"));for(loginfo=System.String.concat(loginfo,"\n Wirkliche Raumpunkte: \n"),c2=0;c2<this.choosePointX.Count;c2=c2+1|0)loginfo=System.String.concat(loginfo,System.String.concat("RealPunkt: Y: ",this.choosePointY.getItem(c2).toString()," X: ",this.choosePointX.getItem(c2).toString(),"\n"));return loginfo},ResetOuterWall:function(){for(var x,y=0;y<this.value;y=y+1|0)for(x=0;x<this.value;x=x+1|0)(y===0||x===(this.value-1|0)||x===0||y===(this.value-1|0))&&this.Dungeon.set([y,x],111)},GenerateRoomPoints:function(){for(var x,rnd=new System.Random.ctor,myval=6,maybePoint=(Bridge.Int.div(this.value,2)|0)-1|0,count=0,setroom=!1,choosePoint=rnd.next$2(0,Bridge.Int.div(Bridge.Int.mul(this.value,this.value),myval)|0),y=0;y<this.value;y=y+1|0)for(x=0;x<this.value;x=x+1|0){if(count=count+1|0,setroom===!1&&count===choosePoint)try{this.Dungeon.get([y-1|0,x])===120&&(this.Dungeon.set([y-1|0,x],119),this.roomPointsY.add(y-1|0),this.roomPointsX.add(x));this.Dungeon.get([y-1|0,x-1|0])===120&&(this.Dungeon.set([y-1|0,x-1|0],119),this.roomPointsY.add(y-1|0),this.roomPointsX.add(x-1|0));this.Dungeon.get([y,x-1|0])===120&&(this.Dungeon.set([y,x-1|0],119),this.roomPointsY.add(y),this.roomPointsX.add(x-1|0));this.Dungeon.get([y,x])===120&&(this.Dungeon.set([y,x],119),this.roomPointsY.add(y),this.roomPointsX.add(x));setroom=!0}catch($e1){$e1=System.Exception.create($e1);choosePoint=choosePoint+1|0}(Bridge.Int.div(Bridge.Int.mul(this.value,this.value),myval)|0)===count&&(choosePoint=rnd.next$2(0,Bridge.Int.div(Bridge.Int.mul(this.value,this.value),myval)|0),count=0,setroom=!1)}},checkRoundHouse:function(y,x,direction){var $t,$t1,copy=this.Dungeon,possible=!0,count=0;switch(($t=($t1=String.fromCharCode(direction).toUpperCase(),System.String.toCharArray($t1,0,$t1.length)))[System.Array.index(0,$t)]){case 85:while(possible===!0)try{if(copy.get([y-count|0,x])===x)count=count+2|0;else return count}catch($e1){return $e1=System.Exception.create($e1),count}break;case 68:while(possible===!0)try{if(copy.get([y+count|0,x])===x)count=count+2|0;else return count}catch($e2){return $e2=System.Exception.create($e2),count}break;case 76:while(possible===!0)try{if(copy.get([y,x-count|0])===x)count=count+2|0;else return count}catch($e3){return $e3=System.Exception.create($e3),count}break;case 82:while(possible===!0)try{if(copy.get([y,x+count|0])===x)count=count+2|0;else return count}catch($e4){return $e4=System.Exception.create($e4),count}}return 1},expand:function(direction,walk1,walk2,posy,posx){var $t,$t1,range,range1,range21,range2,range22,range3,range23;switch(($t=($t1=String.fromCharCode(direction).toUpperCase(),System.String.toCharArray($t1,0,$t1.length)))[System.Array.index(0,$t)]){case 85:for(this.roomOuterPointsX.add(0),this.roomOuterPointsY.add(0),range=0;range<=walk1;range=range+1|0){for(range2=0;range2<=walk2;range2=range2+1|0)this.Dungeon.set([posy-range|0,posx+range2|0],119);this.Dungeon.set([posy-range|0,posx],119);this.roomOuterPointsX.setItem(this.roomOuterPointsX.Count-1|0,Bridge.Int.mul(posx,2));this.roomOuterPointsY.setItem(this.roomOuterPointsY.Count-1|0,Bridge.Int.mul(posy-range|0,2))}break;case 68:for(this.roomOuterPointsX.add(0),this.roomOuterPointsY.add(0),range1=0;range1<=walk1;range1=range1+1|0){for(range21=0;range21<=walk2;range21=range21+1|0)this.Dungeon.set([posy+range1|0,posx+range21|0],119);this.Dungeon.set([posy+range1|0,posx],119);this.roomOuterPointsX.setItem(this.roomOuterPointsX.Count-1|0,posx);this.roomOuterPointsY.setItem(this.roomOuterPointsY.Count-1|0,posy+range1|0)}break;case 76:for(this.roomOuterPointsX.add(0),this.roomOuterPointsY.add(0),range2=0;range2<=walk1;range2=range2+1|0){for(range22=0;range22<=walk2;range22=range22+1|0)this.Dungeon.set([posy-range22|0,posx-range2|0],119);this.Dungeon.set([posy,posx-range2|0],119);this.roomOuterPointsX.setItem(this.roomOuterPointsX.Count-1|0,posx-range2|0);this.roomOuterPointsY.setItem(this.roomOuterPointsY.Count-1|0,posy)}break;case 82:for(this.roomOuterPointsX.add(0),this.roomOuterPointsY.add(0),range3=0;range3<=walk1;range3=range3+1|0){for(range23=0;range23<=walk2;range23=range23+1|0)this.Dungeon.set([posy+range23|0,posx-range3|0],119);this.Dungeon.set([posy,posx+range3|0],119);this.roomOuterPointsX.setItem(this.roomOuterPointsX.Count-1|0,posx+range3|0);this.roomOuterPointsY.setItem(this.roomOuterPointsY.Count-1|0,posy)}}},GenerateRoomFromPoints:function(){for(var maxSize=4,minSize=2,onetime=!1,c=0;c<this.roomPointsX.Count;c=c+1|0){var maxExpandUp=this.checkRoundHouse(this.roomPointsY.getItem(c),this.roomPointsX.getItem(c),117),maxExpandDown=this.checkRoundHouse(this.roomPointsY.getItem(c),this.roomPointsX.getItem(c),100),maxExpandLeft=this.checkRoundHouse(this.roomPointsY.getItem(c),this.roomPointsX.getItem(c),108),maxExpandRight=this.checkRoundHouse(this.roomPointsY.getItem(c),this.roomPointsX.getItem(c),114),chooseRoomSize=0;if(maxExpandUp>=maxSize?chooseRoomSize=chooseRoomSize+maxSize|0:maxExpandUp>=minSize&&maxExpandUp<maxSize&&(chooseRoomSize=chooseRoomSize+minSize|0),maxExpandDown>=maxSize?chooseRoomSize=chooseRoomSize+maxSize|0:maxExpandDown>=minSize&&maxExpandDown<maxSize&&(chooseRoomSize=chooseRoomSize+minSize|0),maxExpandLeft>=maxSize?chooseRoomSize=chooseRoomSize+maxSize|0:maxExpandLeft>=minSize&&maxExpandLeft<maxSize&&(chooseRoomSize=chooseRoomSize+minSize|0),maxExpandRight>=maxSize?chooseRoomSize=chooseRoomSize+maxSize|0:maxExpandRight>=minSize&&maxExpandRight<maxSize&&(chooseRoomSize=chooseRoomSize+minSize|0),onetime===!1){try{this.expand(100,2,2,this.roomPointsY.getItem(c),this.roomPointsX.getItem(c))}catch($e1){$e1=System.Exception.create($e1)}try{this.expand(108,2,2,this.roomPointsY.getItem(c),this.roomPointsX.getItem(c))}catch($e2){$e2=System.Exception.create($e2)}try{this.expand(114,2,2,this.roomPointsY.getItem(c),this.roomPointsX.getItem(c))}catch($e3){$e3=System.Exception.create($e3)}try{this.expand(117,2,2,this.roomPointsY.getItem(c),this.roomPointsX.getItem(c))}catch($e4){$e4=System.Exception.create($e4)}onetime=!1}}},walkNext:function(y,x,direction,wayArt){var $t,$t1,i,i1,i2,i3;wayArt===void 0&&(wayArt=116);switch(($t=($t1=String.fromCharCode(direction).toUpperCase(),System.String.toCharArray($t1,0,$t1.length)))[System.Array.index(0,$t)]){case 85:try{if(this.Dungeon.get([y-2|0,x])===120){for(i=0;i<3;i=i+1|0)this.Dungeon.set([y-i|0,x],wayArt);return!0}return!1}catch($e1){return $e1=System.Exception.create($e1),!1}case 68:try{if(this.Dungeon.get([y+2|0,x])===120){for(i1=0;i1<3;i1=i1+1|0)this.Dungeon.set([y+i1|0,x],wayArt);return!0}return!1}catch($e2){return $e2=System.Exception.create($e2),!1}case 76:try{if(this.Dungeon.get([y,x-2|0])===120){for(i2=0;i2<3;i2=i2+1|0)this.Dungeon.set([y,x-i2|0],wayArt);return!0}return!1}catch($e3){return $e3=System.Exception.create($e3),!1}case 82:try{if(this.Dungeon.get([y,x+2|0])===120){for(i3=0;i3<3;i3=i3+1|0)this.Dungeon.set([y,x+i3|0],wayArt);return!0}return!1}catch($e4){return $e4=System.Exception.create($e4),!1}default:return!1}},walkOne:function(y,x,directory){var $t,$t1;try{switch(($t=($t1=String.fromCharCode(directory).toUpperCase(),System.String.toCharArray($t1,0,$t1.length)))[System.Array.index(0,$t)]){case 85:return this.Dungeon.set([y-1|0,x],99),!0;case 68:return this.Dungeon.set([y+1|0,x],99),!0;case 76:return this.Dungeon.set([y,x-1|0],99),!0;case 82:return this.Dungeon.set([y,x+1|0],99),!0;default:return!1}}catch($e1){return $e1=System.Exception.create($e1),!1}},checkNext:function(y,x,direction){var $t,$t1;switch(($t=($t1=String.fromCharCode(direction).toUpperCase(),System.String.toCharArray($t1,0,$t1.length)))[System.Array.index(0,$t)]){case 85:try{return this.Dungeon.get([y-2|0,x])===120?!0:!1}catch($e1){return $e1=System.Exception.create($e1),!1}case 68:try{return this.Dungeon.get([y+2|0,x])===120?!0:!1}catch($e2){return $e2=System.Exception.create($e2),!1}case 76:try{return this.Dungeon.get([y,x-2|0])===120?!0:!1}catch($e3){return $e3=System.Exception.create($e3),!1}case 82:try{return this.Dungeon.get([y,x+2|0])===120?!0:!1}catch($e4){return $e4=System.Exception.create($e4),!1}default:return!1}},checkSide:function(y,x,direction){var $t,$t1;try{switch(($t=($t1=String.fromCharCode(direction).toUpperCase(),System.String.toCharArray($t1,0,$t1.length)))[System.Array.index(0,$t)]){case 85:return this.Dungeon.get([y+1|0,x])===111?!0:!1;case 68:return this.Dungeon.get([y-1|0,x])===111?!0:!1;case 76:return this.Dungeon.get([y,x-1|0])===111?!0:!1;case 82:return this.Dungeon.get([y,x+1|0])===111?!0:!1;default:return!1}}catch($e1){return $e1=System.Exception.create($e1),!1}},modelCheck:function(y,x,directory){var $t,$t1,countVar=0,y1,x1;try{switch(($t=($t1=String.fromCharCode(directory).toUpperCase(),System.String.toCharArray($t1,0,$t1.length)))[System.Array.index(0,$t)]){case 85:y=y-2|0;x=x-1|0;break;case 68:x=x-1|0;break;case 76:y=y-1|0;break;case 82:y=y-1|0;x=x-2|0}for(y1=0;y1<3;y1=y1+1|0)for(x1=0;x1<3;x1=x1+1|0)this.Dungeon.get([y+y1|0,x+x1|0])===111&&(countVar=countVar+1|0)}catch($e1){$e1=System.Exception.create($e1)}return countVar>=5?!0:!1},GenerateMainWays:function(){for(var i1,rnd,i2,y,x,counter,chooseFromThis,dir,walkPointsY=new(System.Collections.Generic.List$1(System.Int32)),walkPointsX=new(System.Collections.Generic.List$1(System.Int32)),i=0;i<this.roomOuterPointsX.Count;i=i+1|0)try{this.Dungeon.get([this.roomOuterPointsY.getItem(i),this.roomOuterPointsX.getItem(i)])===119&&(this.choosePointY.add(this.roomOuterPointsY.getItem(i)),this.choosePointX.add(this.roomOuterPointsX.getItem(i)))}catch($e1){$e1=System.Exception.create($e1)}for(i1=0;i1<this.choosePointX.Count;i1=i1+1|0)this.checkNext(this.choosePointY.getItem(i1),this.choosePointX.getItem(i1),117)===!0&&(walkPointsY.add(this.choosePointY.getItem(i1)-2|0),walkPointsX.add(this.choosePointX.getItem(i1))),this.checkNext(this.choosePointY.getItem(i1),this.choosePointX.getItem(i1),100)===!0&&(walkPointsY.add(this.choosePointY.getItem(i1)+2|0),walkPointsX.add(this.choosePointX.getItem(i1))),this.checkNext(this.choosePointY.getItem(i1),this.choosePointX.getItem(i1),108)===!0&&(walkPointsY.add(this.choosePointY.getItem(i1)),walkPointsX.add(this.choosePointX.getItem(i1)-2|0)),this.checkNext(this.choosePointY.getItem(i1),this.choosePointX.getItem(i1),114)===!0&&(walkPointsY.add(this.choosePointY.getItem(i1)),walkPointsX.add(this.choosePointX.getItem(i1)+2|0));for(walkPointsX.Count===0,rnd=new System.Random.ctor,i2=0;i2<walkPointsX.Count;i2=i2+1|0){if(y=0,x=0,this.checkNext(walkPointsY.getItem(i2),walkPointsX.getItem(i2),117))this.walkNext(walkPointsY.getItem(i2),walkPointsX.getItem(i2),117),y=walkPointsY.getItem(i2)-2|0,x=walkPointsX.getItem(i2);else if(this.checkNext(walkPointsY.getItem(i2),walkPointsX.getItem(i2),100))this.walkNext(walkPointsY.getItem(i2),walkPointsX.getItem(i2),100),y=walkPointsY.getItem(i2)+2|0,x=walkPointsX.getItem(i2);else if(this.checkNext(walkPointsY.getItem(i2),walkPointsX.getItem(i2),108))this.walkNext(walkPointsY.getItem(i2),walkPointsX.getItem(i2),108),y=walkPointsY.getItem(i2),x=walkPointsX.getItem(i2)-2|0;else if(this.checkNext(walkPointsY.getItem(i2),walkPointsX.getItem(i2),114))this.walkNext(walkPointsY.getItem(i2),walkPointsX.getItem(i2),114),y=walkPointsY.getItem(i2),x=walkPointsX.getItem(i2)+2|0;else continue;for(counter=0,chooseFromThis=new(System.Collections.Generic.List$1(System.Int32)),chooseFromThis=new(System.Collections.Generic.List$1(System.Int32)),chooseFromThis.add(1),chooseFromThis.add(2),chooseFromThis.add(3),chooseFromThis.add(4);this.checkNext(y,x,117)===!0||this.checkNext(y,x,100)===!0||this.checkNext(y,x,108)===!0||this.checkNext(y,x,114)===!0;){if(counter>=500)break;dir=rnd.next$2(0,chooseFromThis.Count-1|0);switch(chooseFromThis.getItem(dir)){case 1:this.checkNext(y,x,117)&&(this.walkNext(y,x,117),y=y-2|0,chooseFromThis=new(System.Collections.Generic.List$1(System.Int32)),chooseFromThis.add(2),chooseFromThis.add(3),chooseFromThis.add(4));break;case 2:this.checkNext(y,x,100)&&(this.walkNext(y,x,100),y=y+2|0,chooseFromThis=new(System.Collections.Generic.List$1(System.Int32)),chooseFromThis.add(1),chooseFromThis.add(3),chooseFromThis.add(4));break;case 3:this.checkNext(y,x,108)&&(this.walkNext(y,x,108),x=x-2|0,chooseFromThis=new(System.Collections.Generic.List$1(System.Int32)),chooseFromThis.add(1),chooseFromThis.add(2),chooseFromThis.add(4));break;case 4:this.checkNext(y,x,114)&&(this.walkNext(y,x,114),x=x+2|0,chooseFromThis=new(System.Collections.Generic.List$1(System.Int32)),chooseFromThis.add(1),chooseFromThis.add(2),chooseFromThis.add(3))}counter=counter+1|0}}},GenerateOtherWays:function(){for(var x,y2,x2,y=0;y<this.value;y=y+1|0)for(x=0;x<this.value;x=x+1|0)if(this.Dungeon.get([y,x])===120)for(y2=y,x2=x;this.checkNext(y2,x2,117)||this.checkNext(y2,x2,100)||this.checkNext(y2,x2,108)||this.checkNext(y2,x2,114);)this.checkNext(y2,x2,117)&&(this.walkNext(y2,x2,117,117),y2=y2-2|0),this.checkNext(y2,x2,100)&&(this.walkNext(y2,x2,100,117),y2=y2+2|0),this.checkNext(y2,x2,108)&&(this.walkNext(y2,x2,108,117),x2=x2-2|0),this.checkNext(y2,x2,114)&&(this.walkNext(y2,x2,114,117),x2=x2+2|0)},ConnectMainWaysToOtherWays:function(){for(var x,y=0;y<this.value;y=y+1|0)for(x=0;x<this.value;x=x+1|0)this.Dungeon.get([y,x])===116&&(this.modelCheck(y,x,117)&&this.walkOne(y,x,117),this.modelCheck(y,x,100)&&this.walkOne(y,x,100),this.modelCheck(y,x,108)&&this.walkOne(y,x,108),this.modelCheck(y,x,114)&&this.walkOne(y,x,114))},MakeLeftoverPointsToCrossings:function(){for(var x,i,a,y=0;y<this.value;y=y+1|0)for(x=0;x<this.value;x=x+1|0)if(this.Dungeon.get([y,x])===120){var count=0,y2=y-1|0,x2=x-1|0;for(i=0;i<3;i=i+1|0)for(a=0;a<3;a=a+1|0)try{this.Dungeon.get([y2+i|0,x2+a|0])!==111&&(count=count+1|0)}catch($e1){$e1=System.Exception.create($e1)}count>=2?this.Dungeon.set([y,x],118):(this.Dungeon.set([y,x],118),this.Dungeon.set([y-1|0,x],118),this.Dungeon.set([y+1|0,x],118),this.Dungeon.set([y,x-1|0],118),this.Dungeon.set([y,x+1|0],118))}},RemoveUselessDeadends:function(){for(var x,i,a,y=0;y<this.value;y=y+1|0)for(x=0;x<this.value;x=x+1|0)if(this.Dungeon.get([y,x])!==111){var y2=y-1|0,x2=x-1|0,count=0;for(i=0;i<3;i=i+1|0)for(a=0;a<3;a=a+1|0)try{this.Dungeon.get([y2+i|0,x2+a|0])!==111&&(count=count+1|0)}catch($e1){$e1=System.Exception.create($e1)}if(count<=2)try{this.Dungeon.get([y-1|0,x])!==111?this.Dungeon.set([y+1|0,x],99):this.Dungeon.get([y+1|0,x])!==111?this.Dungeon.set([y-1|0,x],99):this.Dungeon.get([y,x-1|0])!==111?this.Dungeon.set([y,x+1|0],99):this.Dungeon.get([y,x+1|0])!==111&&this.Dungeon.set([y,x-1|0],99)}catch($e2){$e2=System.Exception.create($e2)}}},MakeRoomConnectionComplete:function(){for(var i=0;i<this.choosePointX.Count;i=i+1|0){if(this.checkSide(this.choosePointY.getItem(i),this.choosePointX.getItem(i),117))try{this.Dungeon.set([this.choosePointY.getItem(i)+1|0,this.choosePointX.getItem(i)],99)}catch($e1){$e1=System.Exception.create($e1)}if(this.checkSide(this.choosePointY.getItem(i),this.choosePointX.getItem(i),100))try{this.Dungeon.set([this.choosePointY.getItem(i)-1|0,this.choosePointX.getItem(i)],99)}catch($e2){$e2=System.Exception.create($e2)}if(this.checkSide(this.choosePointY.getItem(i),this.choosePointX.getItem(i),108))try{this.Dungeon.set([this.choosePointY.getItem(i),this.choosePointX.getItem(i)-1|0],99)}catch($e3){$e3=System.Exception.create($e3)}if(this.checkSide(this.choosePointY.getItem(i),this.choosePointX.getItem(i),114))try{this.Dungeon.set([this.choosePointY.getItem(i),this.choosePointX.getItem(i)+1|0],99)}catch($e4){$e4=System.Exception.create($e4)}}},SetSpawnAndDestinationPoint:function(){try{this.Dungeon.set([this.roomPointsY.getItem(0),this.roomPointsX.getItem(0)],115);this.Dungeon.set([this.roomPointsY.getItem(this.roomPointsY.Count-1|0),this.roomPointsX.getItem(this.roomPointsX.Count-1|0)],101)}catch($e1){$e1=System.Exception.create($e1)}}}});Bridge.define("Test.Program",{main:function(){for(var x,mylab=new Test.Labyrinth(35),y=0;y<35;y=y+1|0){for(x=0;x<35;x=x+1|0)System.Console.Write(String.fromCharCode(mylab.Dungeon.get([y,x])));System.Console.WriteLine("\n")}}})});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICJ0ZXN0anMubWluLmpzIiwKICAic291cmNlUm9vdCI6ICIiLAogICJzb3VyY2VzIjogW10sCiAgIm5hbWVzIjogW10sCiAgIm1hcHBpbmdzIjogIiIsCiAgInNvdXJjZXNDb250ZW50IjogW10KfQo=
